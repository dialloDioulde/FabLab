{% include "siteWeb/includes/dashboard.html" %}

{% load crispy_forms_tags %}

{% load static %}

{% block content %}
<head>
      <script src="{% static 'jquery/external/jquery/tableSearch.js' %}"></script>
</head>

<div class="container">
    <div class="container-fluid">
            <h2>Materials</h2>
          <p>Type something in the input field to search the table for first names, last names or emails:</p>
          <input class="form-control" id="myInput" type="text" placeholder="Search..">
          <br>
         <a class="btn btn-success add-form offset-12" href="/addMaterial">
                <span><i class="fas fa-plus"></i> Add Material</span>
         </a>
    </div>
    <div class="table-responsive table-body">
        <table class="table container-fluid table-responsive mt-2">

            <thead class="thead-dark">
                <tr>
                    <th scope="col">NAME</th>
                    <th scope="col">BARCODE</th>
                    <th scope="col">TYPE</th>
                     <th scope="col">DESCRIPTION</th>
                    <th scope="col">CREATION DATE</th>
                    <th scope="col">ACTIONS</th>
                </tr>
            </thead>

            {% for material in materials %}
            <tbody id="myTable">
            <tr>
                <td scope="row" class="col-md-1">{{material.name}}</td>
                <td scope="col" class="col-md-1">{{material.id}}</td>
                <td scope="col" class="col-md-1">{{material.slug}}</td>
                <td scope="col" class="col-md-1">{{material.type }}</td>
                <td scope="col" class="col-md-1">{{material.creation_date_mat}}</td>
                <td scope="col" class="col-md-1">
                    <a href="/updateMaterial/{{material.id}}" class="btn btn-warning"><span class="glyphicon glyphicon-pencil mr-2"></span>Edit</a>
                    <button  class="btn btn-danger ml-2" onClick="deleteMaterial({{material.id}})">
                        <span class="glyphicon glyphicon-trash mr-2"></span>Delete
                    </button>
                </td>
            </tr>
            </tbody>
            {% endfor %}
        </table>
    </div>
</div>
{% endblock %}


{% block javascript %}
<script>
 // Delete Material----------------------------------------------------------------------------------------------------//
function deleteMaterial(id) {
  var action_delete = confirm("Are you sure you want to delete this Material?");
  if (action_delete == true) {
    $.ajax({
        url: '{% url "DeleteCrudMaterial" %}',
        data: {
            'id': id,
        },
        dataType: 'json',
        success: function (data) {
            if (data.deleted) {
              alert("Material is deleted");
              location.reload(true);
            }
        }
    });
  }
};
// END Delete Material -----------------------------------------------------------------------------------------------//
</script>

{% endblock javascript %}